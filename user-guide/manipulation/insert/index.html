
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      
      <meta name="generator" content="mkdocs-0.16.2, mkdocs-material-1.6.1">
    
    
      
        <title>INSERT - Beam Documentation</title>
      
    
    
      <script src="../../../assets/javascripts/modernizr-56ade86843.js"></script>
    
    

      <link rel="stylesheet" href="../../../assets/stylesheets/application-4d0d3f2fbf.css">
      
    
<link rel="stylesheet" type="text/css" href="/css/beam.css"/>

    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../../../theme/css/beam.css">
    
    
  </head>
  
  
  
  
    <body>
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="../../.." title="Beam Documentation" class="md-logo md-header-nav__button">
            <img src="../../../img/logo.svg" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  User Guide
                </span>
              
                <span class="md-header-nav__parent">
                  Data Manipulation
                </span>
              
            
            INSERT
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/tathougies/beam" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../../img/logo.svg">
      </i>
    
    Beam Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/tathougies/beam" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      tathougies/beam
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../about/faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial1/" title="Part 1" class="md-nav__link">
      Part 1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial2/" title="Part 2" class="md-nav__link">
      Part 2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../tutorials/tutorial3/" title="Part 3" class="md-nav__link">
      Part 3
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../backends/" title="Backends" class="md-nav__link">
      Backends
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../expressions/" title="Expressions" class="md-nav__link">
      Expressions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Queries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Queries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/basic/" title="Basic Queries" class="md-nav__link">
      Basic Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/select/" title="More complex SELECTs" class="md-nav__link">
      More complex SELECTs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/ordering/" title="Ordering" class="md-nav__link">
      Ordering
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/relationships/" title="Relationships" class="md-nav__link">
      Relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/aggregates/" title="Aggregates" class="md-nav__link">
      Aggregates
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/combining-queries/" title="Combining queries" class="md-nav__link">
      Combining queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/window-functions/" title="Window functions" class="md-nav__link">
      Window functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../queries/advanced-features/" title="Advanced features" class="md-nav__link">
      Advanced features
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../extensibility/" title="Custom queries" class="md-nav__link">
      Custom queries
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7" checked>
    
    <label class="md-nav__link" for="nav-4-7">
      Data Manipulation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        Data Manipulation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        INSERT
      </label>
    
    <a href="./" title="INSERT" class="md-nav__link md-nav__link--active">
      INSERT
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#inserting-explicit-new-values" title="Inserting explicit new values" class="md-nav__link">
    Inserting explicit new values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-calculated-values" title="Inserting calculated values" class="md-nav__link">
    Inserting calculated values
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrieving-the-rows-inserted" title="Retrieving the rows inserted" class="md-nav__link">
    Retrieving the rows inserted
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-from-the-result-of-a-select-statement" title="Inserting from the result of a SELECT statement" class="md-nav__link">
    Inserting from the result of a SELECT statement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-a-subset-of-columns" title="Choosing a subset of columns" class="md-nav__link">
    Choosing a subset of columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-nothing" title="Inserting nothing" class="md-nav__link">
    Inserting nothing
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../update/" title="UPDATE" class="md-nav__link">
      UPDATE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../delete/" title="DELETE" class="md-nav__link">
      DELETE
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Schema management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Schema management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/migrations/" title="The Migrations Framework" class="md-nav__link">
      The Migrations Framework
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/tool/" title="The beam-migrate tool" class="md-nav__link">
      The beam-migrate tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../schema-guide/supported/" title="Supported migrations" class="md-nav__link">
      Supported migrations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Backends
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Backends
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../backends/beam-postgres/" title="beam-postgres" class="md-nav__link">
      beam-postgres
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../backends/beam-sqlite/" title="beam-sqlite" class="md-nav__link">
      beam-sqlite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../custom-backends/" title="Writing a Custom Backend" class="md-nav__link">
      Writing a Custom Backend
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/compatibility/" title="Compatibility Matrix" class="md-nav__link">
      Compatibility Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../about/release-notes/" title="Release Notes" class="md-nav__link">
      Release Notes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#inserting-explicit-new-values" title="Inserting explicit new values" class="md-nav__link">
    Inserting explicit new values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-calculated-values" title="Inserting calculated values" class="md-nav__link">
    Inserting calculated values
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrieving-the-rows-inserted" title="Retrieving the rows inserted" class="md-nav__link">
    Retrieving the rows inserted
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-from-the-result-of-a-select-statement" title="Inserting from the result of a SELECT statement" class="md-nav__link">
    Inserting from the result of a SELECT statement
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#choosing-a-subset-of-columns" title="Choosing a subset of columns" class="md-nav__link">
    Choosing a subset of columns
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inserting-nothing" title="Inserting nothing" class="md-nav__link">
    Inserting nothing
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>INSERT</h1>
                
                <p>SQL <code>INSERT</code> expressions allow you to insert rows in the database.</p>
<p>There is a lot of variety in how you can provide new data, and Beam supports all
standard ways.</p>
<p>The <code>insert</code> function from <code>Database.Beam.Query</code> can be used to insert rows into
a particular table. <code>insert</code> takes a table and a source of values, represented
by <code>SqlInsertValues</code>, and returns a <code>SqlInsert</code> object that can be run in a
<code>MonadBeam</code> with <code>runInsert</code>.</p>
<p>The <code>SqlInsertValues</code> type takes two type parameters. The first is the
underlying database syntax, and the second is the shape of the data it carries,
specified as a beam table type. For example, a source of values in Postgres that
can be inserted in the Chinook customers table would have the type
<code>SqlInsertValues PgInsertValuesSyntax CustomerT</code>. This abstracts over where
those values actually are. The values may be explicit haskell values,
expressions returning customers, a query returning customers, or something
else. Either way, they can all be used in the same way with the <code>insert</code>
function.</p>
<h2 id="inserting-explicit-new-values">Inserting explicit new values</h2>
<p>If you have a record of explicit Haskell values, use the <code>insertValues</code>
function. For example, to insert a new playlist into our chinook database</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-0-Haskell" aria-controls="tab-0-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-Sqlite" aria-controls="tab-0-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-0-Postgres" aria-controls="tab-0-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-0-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertValues</span> <span class="p">[</span> <span class="kt">Playlist</span> <span class="mi">700</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;My New Playlist&quot;</span><span class="p">)</span>
               <span class="p">,</span> <span class="kt">Playlist</span> <span class="mi">701</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Another Playlist&quot;</span><span class="p">)</span>
               <span class="p">,</span> <span class="kt">Playlist</span> <span class="mi">702</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Look... more playlists&quot;</span><span class="p">)</span> <span class="p">]</span>

<span class="nf">insertedPlaylists</span> <span class="ow">&lt;-</span>
  <span class="n">runSelectReturningList</span> <span class="o">$</span>
  <span class="n">select</span> <span class="o">$</span> <span class="n">filter_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">playlistId</span> <span class="n">p</span> <span class="o">&gt;=.</span> <span class="mi">700</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">all_</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span>

<span class="nf">putStrLn</span> <span class="s">&quot;Inserted playlists:&quot;</span>
<span class="nf">forM_</span> <span class="n">insertedPlaylists</span> <span class="o">$</span> <span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span>
  <span class="n">putStrLn</span> <span class="p">(</span><span class="n">show</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">),</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
             <span class="o">?</span><span class="p">),</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
                  <span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 700,SQLText &quot;My New Playlist&quot;,SQLInteger 701,SQLText &quot;Another Playlist&quot;,SQLInteger 702,SQLText &quot;Look... more playlists&quot;];</span>

<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="p">(</span><span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 700];</span>
<span class="c1">-- Output: Inserted playlists:</span>
<span class="c1">-- Output: Playlist {playlistId = 700, playlistName = Just &quot;My New Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 701, playlistName = Just &quot;Another Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 702, playlistName = Just &quot;Look... more playlists&quot;}</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-0-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span>
        <span class="s1">&#39;My New Playlist&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">701</span><span class="p">,</span>
                             <span class="s1">&#39;Another Playlist&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">702</span><span class="p">,</span>
                                                   <span class="s1">&#39;Look... more playlists&#39;</span><span class="p">);</span>


<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">700</span><span class="p">);</span>

<span class="c1">-- Output: Inserted playlists:</span>
<span class="c1">-- Output: Playlist {playlistId = 700, playlistName = Just &quot;My New Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 701, playlistName = Just &quot;Another Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 702, playlistName = Just &quot;Look... more playlists&quot;}</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h2 id="inserting-calculated-values">Inserting calculated values</h2>
<p>Inserting explicit values is all well and good, but sometimes we want to defer
some processing to the database. For example, perhaps we want to create a new
invoice and use the current time as the invoice date. We could grab the current
time using <code>getCurrentTime</code> and then use this to construct an explicit Haskell
value, but this may cause synchronization issues for our application. To do
this, beam allows us to specify arbitrary expressions as a source of values
using the <code>insertExpressions</code> function.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-1-Haskell" aria-controls="tab-1-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-Sqlite" aria-controls="tab-1-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-1-Postgres" aria-controls="tab-1-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-1-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertExpressions</span> <span class="p">[</span> <span class="kt">Invoice</span> <span class="p">(</span><span class="n">val_</span> <span class="mi">800</span><span class="p">)</span> <span class="p">(</span><span class="kt">CustomerId</span> <span class="p">(</span><span class="n">val_</span> <span class="mi">1</span><span class="p">))</span> <span class="n">currentTimestamp_</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="p">(</span><span class="kt">Address</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;123 My Street&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Buenos Noches&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Rio&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Mozambique&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;ABCDEF&quot;</span><span class="p">)))</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">]</span>

<span class="kt">Just</span> <span class="n">newInvoice</span> <span class="ow">&lt;-</span>
  <span class="n">runSelectReturningOne</span> <span class="o">$</span>
  <span class="n">lookup_</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="p">(</span><span class="kt">InvoiceId</span> <span class="mi">800</span><span class="p">)</span>

<span class="nf">putStrLn</span> <span class="p">(</span><span class="s">&quot;Inserted invoice: &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">newInvoice</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 800,SQLInteger 1,SQLText &quot;123 My Street&quot;,SQLText &quot;Buenos Noches&quot;,SQLText &quot;Rio&quot;,SQLText &quot;Mozambique&quot;,SQLText &quot;ABCDEF&quot;,SQLText &quot;1000.0&quot;];</span>

<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res5&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res6&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res7&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Total&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res8&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 800];</span>
<span class="c1">-- Output: Inserted invoice: Invoice {invoiceId = SqlSerial {unSerial = 800}, invoiceCustomer = CustomerId 1, invoiceDate = 2018-03-23 00:58:12, invoiceBillingAddress = Address {address = Just &quot;123 My Street&quot;, addressCity = Just &quot;Buenos Noches&quot;, addressState = Just &quot;Rio&quot;, addressCountry = Just &quot;Mozambique&quot;, addressPostalCode = Just &quot;ABCDEF&quot;}, invoiceTotal = 1000.0}</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-1-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="mi">800</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
        <span class="s1">&#39;123 My Street&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Buenos Noches&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rio&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mozambique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ABCDEF&#39;</span><span class="p">,</span>
        <span class="s1">&#39;1000.0&#39;</span><span class="p">);</span>


<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceDate&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingAddress&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingCity&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingState&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res5&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingCountry&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res6&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;BillingPostalCode&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res7&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Total&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res8&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Invoice&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="mi">800</span><span class="p">);</span>

<span class="c1">-- Output: Inserted invoice: Invoice {invoiceId = SqlSerial {unSerial = 800}, invoiceCustomer = CustomerId 1, invoiceDate = 2018-03-22 17:58:15.381815, invoiceBillingAddress = Address {address = Just &quot;123 My Street&quot;, addressCity = Just &quot;Buenos Noches&quot;, addressState = Just &quot;Rio&quot;, addressCountry = Just &quot;Mozambique&quot;, addressPostalCode = Just &quot;ABCDEF&quot;}, invoiceTotal = 1000.0}</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p><code>insertExpressions</code> is strictly more general than <code>insertValues</code>. We can turn
any <code>insertValues</code> to an <code>insertExpressions</code> by running every table value
through the <code>val_</code> function to convert a Haskell literal to an expression.</p>
<p>For example, we can write the playlist example above as</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-2-Haskell" aria-controls="tab-2-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-Sqlite" aria-controls="tab-2-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-2-Postgres" aria-controls="tab-2-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-2-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertExpressions</span> <span class="p">[</span> <span class="n">val_</span> <span class="o">$</span> <span class="kt">Playlist</span> <span class="mi">700</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;My New Playlist&quot;</span><span class="p">)</span>
                    <span class="p">,</span> <span class="n">val_</span> <span class="o">$</span> <span class="kt">Playlist</span> <span class="mi">701</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Another Playlist&quot;</span><span class="p">)</span>
                    <span class="p">,</span> <span class="n">val_</span> <span class="o">$</span> <span class="kt">Playlist</span> <span class="mi">702</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Look... more playlists&quot;</span><span class="p">)</span> <span class="p">]</span>

<span class="nf">insertedPlaylists</span> <span class="ow">&lt;-</span>
  <span class="n">runSelectReturningList</span> <span class="o">$</span>
  <span class="n">select</span> <span class="o">$</span> <span class="n">filter_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">playlistId</span> <span class="n">p</span> <span class="o">&gt;=.</span> <span class="mi">700</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">all_</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span>

<span class="nf">putStrLn</span> <span class="s">&quot;Inserted playlists:&quot;</span>
<span class="nf">forM_</span> <span class="n">insertedPlaylists</span> <span class="o">$</span> <span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span>
  <span class="n">putStrLn</span> <span class="p">(</span><span class="n">show</span> <span class="n">p</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">),</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
             <span class="o">?</span><span class="p">),</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
                  <span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 700,SQLText &quot;My New Playlist&quot;,SQLInteger 701,SQLText &quot;Another Playlist&quot;,SQLInteger 702,SQLText &quot;Look... more playlists&quot;];</span>

<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="p">(</span><span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 700];</span>
<span class="c1">-- Output: Inserted playlists:</span>
<span class="c1">-- Output: Playlist {playlistId = 700, playlistName = Just &quot;My New Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 701, playlistName = Just &quot;Another Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 702, playlistName = Just &quot;Look... more playlists&quot;}</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-2-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="mi">700</span><span class="p">,</span>
        <span class="s1">&#39;My New Playlist&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">701</span><span class="p">,</span>
                             <span class="s1">&#39;Another Playlist&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">702</span><span class="p">,</span>
                                                   <span class="s1">&#39;Look... more playlists&#39;</span><span class="p">);</span>


<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">700</span><span class="p">);</span>

<span class="c1">-- Output: Inserted playlists:</span>
<span class="c1">-- Output: Playlist {playlistId = 700, playlistName = Just &quot;My New Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 701, playlistName = Just &quot;Another Playlist&quot;}</span>
<span class="c1">-- Output: Playlist {playlistId = 702, playlistName = Just &quot;Look... more playlists&quot;}</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p>One common use of <code>insertExpressions_</code> is when adding new rows to tables where
one field needs to be set to the default value. For example, auto-incrementing
keys or random UUIDs are a common way to assign primary keys to rows. You can
use <code>insertExpressions_</code> using the <code>default_</code> expression for each column that
you want to use the default value for.</p>
<p>For example, the query below adds a new invoice asking the database to assign a
new id.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-3-Haskell" aria-controls="tab-3-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-3-Postgres" aria-controls="tab-3-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-3-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertExpressions</span> <span class="p">[</span> <span class="kt">Invoice</span> <span class="n">default_</span> <span class="c1">-- Ask the database to give us a default id</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="p">(</span><span class="kt">CustomerId</span> <span class="mi">1</span><span class="p">))</span> <span class="n">currentTimestamp_</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="p">(</span><span class="kt">Address</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;123 My Street&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Buenos Noches&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Rio&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Mozambique&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;ABCDEF&quot;</span><span class="p">)))</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">]</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-3-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="k">DEFAULT</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
        <span class="s1">&#39;123 My Street&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Buenos Noches&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rio&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mozambique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ABCDEF&#39;</span><span class="p">,</span>
        <span class="s1">&#39;1000.0&#39;</span><span class="p">);</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>SQLite is a great little backend, but it doesn't support some standard SQL
features, like the <code>DEFAULT</code> keyword in inserts. You can retrieve the same
functionality by only inserting into a subset of columns. See the section on
<a href="#choosing-a-subset-of-columns">that</a> below.</p>
</div>
<h3 id="retrieving-the-rows-inserted">Retrieving the rows inserted</h3>
<p>However, now we have no way of knowing <em>what</em> value the database
assigned. Unfortunately, there is no database-agnostic solution to this
problem. However, it's a common enough use case that beam provides a
backend-agnostic way for some backends. Backends that provide this functionality
provide an instance of <code>MonadBeamInsertReturning</code>. In order to use this class,
you'll need to explicitly import
<code>Database.Beam.Backend.SQL.BeamExtensions</code>. Below, we've imported this module
qualified.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-4-Haskell" aria-controls="tab-4-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-4-Sqlite" aria-controls="tab-4-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-4-Postgres" aria-controls="tab-4-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-4-Haskell">
            <div class="codehilite"><pre><span></span><span class="p">[</span><span class="n">newInvoice</span><span class="p">]</span> <span class="ow">&lt;-</span>
  <span class="kt">BeamExtensions</span><span class="o">.</span><span class="n">runInsertReturningList</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertExpressions</span> <span class="p">[</span> <span class="kt">Invoice</span> <span class="n">default_</span> <span class="c1">-- Ask the database to give us a default id</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="p">(</span><span class="kt">CustomerId</span> <span class="mi">1</span><span class="p">))</span> <span class="n">currentTimestamp_</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="p">(</span><span class="kt">Address</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;123 My Street&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Buenos Noches&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Rio&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;Mozambique&quot;</span><span class="p">)</span> <span class="p">(</span><span class="kt">Just</span> <span class="s">&quot;ABCDEF&quot;</span><span class="p">)))</span>
                              <span class="p">(</span><span class="n">val_</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">]</span>

<span class="nf">putStrLn</span> <span class="p">(</span><span class="s">&quot;We inserted a new invoice, and the result was &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">newInvoice</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-4-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="o">?</span><span class="p">,</span>
        <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">,</span>
        <span class="o">?</span><span class="p">);</span>

<span class="c1">-- With values: [SQLInteger 1,SQLText &quot;123 My Street&quot;,SQLText &quot;Buenos Noches&quot;,SQLText &quot;Rio&quot;,SQLText &quot;Mozambique&quot;,SQLText &quot;ABCDEF&quot;,SQLText &quot;1000.0&quot;];</span>
<span class="c1">-- Output: We inserted a new invoice, and the result was Invoice {invoiceId = SqlSerial {unSerial = 413}, invoiceCustomer = CustomerId 1, invoiceDate = 2018-03-23 00:58:27, invoiceBillingAddress = Address {address = Just &quot;123 My Street&quot;, addressCity = Just &quot;Buenos Noches&quot;, addressState = Just &quot;Rio&quot;, addressCountry = Just &quot;Mozambique&quot;, addressPostalCode = Just &quot;ABCDEF&quot;}, invoiceTotal = 1000.0}</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-4-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;InvoiceId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">VALUES</span> <span class="p">(</span><span class="k">DEFAULT</span><span class="p">,</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span>
        <span class="s1">&#39;123 My Street&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Buenos Noches&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rio&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mozambique&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ABCDEF&#39;</span><span class="p">,</span>
        <span class="s1">&#39;1000.0&#39;</span><span class="p">)</span> <span class="n">RETURNING</span> <span class="ss">&quot;InvoiceId&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;Total&quot;</span><span class="p">;</span>

<span class="c1">-- Output: We inserted a new invoice, and the result was Invoice {invoiceId = SqlSerial {unSerial = 570}, invoiceCustomer = CustomerId 1, invoiceDate = 2018-03-22 17:58:30.255346, invoiceBillingAddress = Address {address = Just &quot;123 My Street&quot;, addressCity = Just &quot;Buenos Noches&quot;, addressState = Just &quot;Rio&quot;, addressCountry = Just &quot;Mozambique&quot;, addressPostalCode = Just &quot;ABCDEF&quot;}, invoiceTotal = 1000.0}</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<p>The pattern match on the single <code>newInvoice</code> is safe, even though its
partial. In general, you can expect the same amount of rows returned as
specified in your <code>SqlInsertValues</code>. If you know what this is statically, then
you can feel free to pattern match directly. Otherwise (if you used
<code>insertFrom</code>, for example), you'll need to handle the possibility that nothing
was inserted.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Note that unlike the standard beam <code>INSERT</code> functionality, which can run any
<code>SqlInsert</code>, <code>runInsertReturningList</code> requires that we supply a table and a
<code>SqlInsertValues</code>.</p>
<p>This is because this functionality is emulated on some backends. Some
backends (such as postgres) provide a more advanced <code>INSERT .. RETURNING</code>
statement that can be used more like <code>SqlInsert</code>. See the backend
documentation for more details.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although SQLite has no support for the <code>DEFAULT</code> clause,
<code>MonadBeamInsertReturning</code> in <code>beam-sqlite</code> inserts rows one at a time and
will detect usage of the <code>DEFAULT</code> keyword. The beam authors consider this
okay. While most beam statements are guaranteed to translate directly to the
underlying DBMS system, <code>runInsertReturningList</code> is explicitly marked as
emulated functionality.</p>
</div>
<h2 id="inserting-from-the-result-of-a-select-statement">Inserting from the result of a <code>SELECT</code> statement</h2>
<p>Sometimes you want to use existing data to insert values. For example, perhaps
we want to give every customer their own playlist, titled "<name>'s playlist".</p>
<p>We can use the <code>insertFrom</code> function to make a <code>SqlInsertValues</code> corresponding
to the result of a query. Make sure to return a projection with the same 'shape'
as your data. If not, you'll get a compile time error.</p>
<p>For example, to create the playlists as above</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-5-Haskell" aria-controls="tab-5-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-5-Sqlite" aria-controls="tab-5-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-5-Postgres" aria-controls="tab-5-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-5-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertFrom</span> <span class="o">$</span> <span class="kr">do</span>
    <span class="n">c</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">customer</span> <span class="n">chinookDb</span><span class="p">)</span>
    <span class="n">pure</span> <span class="p">(</span><span class="kt">Playlist</span> <span class="p">(</span><span class="n">customerId</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">(</span><span class="n">just_</span> <span class="p">(</span><span class="n">concat_</span> <span class="p">[</span> <span class="n">customerFirstName</span> <span class="n">c</span><span class="p">,</span> <span class="s">&quot;&#39;s Playlist&quot;</span> <span class="p">])))</span>

<span class="nf">playlists</span> <span class="ow">&lt;-</span> <span class="n">runSelectReturningList</span> <span class="o">$</span> <span class="n">select</span> <span class="o">$</span> <span class="n">limit_</span> <span class="mi">10</span> <span class="o">$</span>
             <span class="n">orderBy_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">asc_</span> <span class="p">(</span><span class="n">playlistId</span> <span class="n">p</span><span class="p">))</span> <span class="o">$</span>
             <span class="n">filter_</span> <span class="p">(</span><span class="nf">\</span><span class="n">p</span> <span class="ow">-&gt;</span> <span class="n">playlistId</span> <span class="n">p</span> <span class="o">&gt;=.</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">$</span>
             <span class="n">all_</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span>

<span class="nf">putStrLn</span> <span class="s">&quot;Inserted playlists&quot;</span>
<span class="nf">forM_</span> <span class="n">playlists</span> <span class="o">$</span> <span class="nf">\</span><span class="n">playlist</span> <span class="ow">-&gt;</span>
  <span class="n">putStrLn</span> <span class="p">(</span><span class="s">&quot;  - &quot;</span> <span class="o">++</span> <span class="n">show</span> <span class="n">playlist</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-5-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="o">?</span><span class="p">)</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;FirstName&quot;</span> <span class="o">||</span> <span class="p">(</span><span class="o">?</span><span class="p">))</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Customer&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span><span class="p">;</span>

<span class="c1">-- With values: [SQLInteger 1000,SQLText &quot;&#39;s Playlist&quot;];</span>

<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span><span class="o">&gt;=</span><span class="p">(</span><span class="o">?</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">ASC</span>
<span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">-- With values: [SQLInteger 1000];</span>
<span class="c1">-- Output: Inserted playlists</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1001, playlistName = Just &quot;Lu\237s&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1002, playlistName = Just &quot;Leonie&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1003, playlistName = Just &quot;Fran\231ois&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1004, playlistName = Just &quot;Bj\248rn&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1005, playlistName = Just &quot;Franti\353ek&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1006, playlistName = Just &quot;Helena&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1007, playlistName = Just &quot;Astrid&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1008, playlistName = Just &quot;Daan&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1009, playlistName = Just &quot;Kara&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1010, playlistName = Just &quot;Eduardo&#39;s Playlist&quot;}</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-5-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Playlist&quot;</span><span class="p">(</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">,</span>
                       <span class="ss">&quot;Name&quot;</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1000</span><span class="p">)</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="n">CONCAT</span><span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;FirstName&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;&#39;s Playlist&#39;</span><span class="p">)</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Customer&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span><span class="p">;</span>


<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Name&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Playlist&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span>
<span class="k">WHERE</span> <span class="p">(</span><span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PlaylistId&quot;</span> <span class="k">ASC</span>
<span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>

<span class="c1">-- Output: Inserted playlists</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1001, playlistName = Just &quot;Lu\237s&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1002, playlistName = Just &quot;Leonie&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1003, playlistName = Just &quot;Fran\231ois&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1004, playlistName = Just &quot;Bj\345rn&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1005, playlistName = Just &quot;Franti\154ek&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1006, playlistName = Just &quot;Helena&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1007, playlistName = Just &quot;Astrid&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1008, playlistName = Just &quot;Daan&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1009, playlistName = Just &quot;Kara&#39;s Playlist&quot;}</span>
<span class="c1">-- Output:   - Playlist {playlistId = 1010, playlistName = Just &quot;Eduardo&#39;s Playlist&quot;}</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h2 id="choosing-a-subset-of-columns">Choosing a subset of columns</h2>
<p>Above, we used the <code>default_</code> clause to set a column to a default
value. Unfortunately, not all backends support <code>default_</code> (SQLite being a
notable exception). Moreover, some <code>INSERT</code> forms simply can't use <code>default_</code>,
such as <code>insertFrom_</code> (you can't return <code>default_</code> from a query). The standard
SQL tool used in these cases is limiting the inserted data to specific
columns. For example, suppose we want to insert new invoices for every customer
with today's date. We can use the <code>insertOnly</code> function to project which field's
are being inserted.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-6-Haskell" aria-controls="tab-6-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-6-Sqlite" aria-controls="tab-6-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-6-Postgres" aria-controls="tab-6-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-6-Haskell">
            <div class="codehilite"><pre><span></span><span class="nf">runInsert</span> <span class="o">$</span>
  <span class="n">insertOnly</span> <span class="p">(</span><span class="n">invoice</span> <span class="n">chinookDb</span><span class="p">)</span>
             <span class="p">(</span><span class="nf">\</span><span class="n">i</span> <span class="ow">-&gt;</span> <span class="p">(</span> <span class="n">invoiceCustomer</span> <span class="n">i</span><span class="p">,</span> <span class="n">invoiceDate</span> <span class="n">i</span><span class="p">,</span> <span class="n">invoiceBillingAddress</span> <span class="n">i</span><span class="p">,</span> <span class="n">invoiceTotal</span> <span class="n">i</span> <span class="p">)</span> <span class="p">)</span> <span class="o">$</span>
  <span class="n">insertFrom</span> <span class="o">$</span> <span class="kr">do</span>
    <span class="n">c</span> <span class="ow">&lt;-</span> <span class="n">all_</span> <span class="p">(</span><span class="n">customer</span> <span class="n">chinookDb</span><span class="p">)</span>

    <span class="c1">-- We&#39;ll just charge each customer $10 to be mean!</span>
    <span class="n">pure</span> <span class="p">(</span><span class="n">primaryKey</span> <span class="n">c</span><span class="p">,</span> <span class="n">currentTimestamp_</span><span class="p">,</span> <span class="n">customerAddress</span> <span class="n">c</span><span class="p">,</span> <span class="n">as_</span> <span class="o">@</span><span class="kt">Scientific</span> <span class="o">$</span> <span class="n">val_</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-6-Sqlite">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="k">CURRENT_TIMESTAMP</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Address&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;City&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;State&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Country&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res5&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PostalCode&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res6&quot;</span><span class="p">,</span>
                            <span class="o">?</span> <span class="k">AS</span> <span class="ss">&quot;res7&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Customer&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span><span class="p">;</span>

<span class="c1">-- With values: [SQLText &quot;10.0&quot;];</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-6-Postgres">
            <div class="codehilite"><pre><span></span><span class="k">INSERT</span> <span class="k">INTO</span> <span class="ss">&quot;Invoice&quot;</span><span class="p">(</span><span class="ss">&quot;CustomerId&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;InvoiceDate&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingAddress&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCity&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingState&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingCountry&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;BillingPostalCode&quot;</span><span class="p">,</span>
                      <span class="ss">&quot;Total&quot;</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;CustomerId&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res0&quot;</span><span class="p">,</span>
       <span class="k">CURRENT_TIMESTAMP</span> <span class="k">AS</span> <span class="ss">&quot;res1&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Address&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res2&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;City&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res3&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;State&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res4&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;Country&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res5&quot;</span><span class="p">,</span>
                            <span class="ss">&quot;t0&quot;</span><span class="p">.</span><span class="ss">&quot;PostalCode&quot;</span> <span class="k">AS</span> <span class="ss">&quot;res6&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;10.0&#39;</span> <span class="k">AS</span> <span class="ss">&quot;res7&quot;</span>
<span class="k">FROM</span> <span class="ss">&quot;Customer&quot;</span> <span class="k">AS</span> <span class="ss">&quot;t0&quot;</span><span class="p">;</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
<h2 id="inserting-nothing">Inserting nothing</h2>
<p>Oftentimes, the values to be inserted are generated automatically by some
Haskell function, and you just insert the resulting list. Sometimes, these lists
may be empty. If you blindly translated this into SQL, you'd end up with
<code>INSERT</code>s with empty <code>VALUE</code> clauses, which are illegal. Beam actually handles
this gracefully. If a <code>SqlInsertValues</code> has no rows to insert, the <code>SqlInsert</code>
returned by <code>insert</code> will know that it is empty. Running this <code>SqlInsert</code>
results in nothing being sent to the database, which you can verify below.</p>
<p>
                <div class="code-nav-container">
                    
        <ul class="nav nav-tabs">
            
        <li class="nav-item">
            <a href="#tab-23-Haskell" aria-controls="tab-23-Haskell" role="tab" data-toggle="tab" data-lang="haskell">Haskell</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-23-Sqlite" aria-controls="tab-23-Sqlite" role="tab" data-toggle="tab" data-lang="sql">Sqlite</a>
        </li>
    
        <li class="nav-item">
            <a href="#tab-23-Postgres" aria-controls="tab-23-Postgres" role="tab" data-toggle="tab" data-lang="sql">Postgres</a>
        </li>
    
        </ul>
    
        <div class="tab-content">
            
        <div role="tabpanel" class="tab-pane active" id="tab-23-Haskell">
            <div class="codehilite"><pre><span></span><span class="kr">let</span> <span class="n">superComplicatedAction</span> <span class="ow">=</span> <span class="n">pure</span> <span class="kt">[]</span> <span class="c1">-- Hopefully, you&#39;re more creative!</span>

<span class="nf">valuesToInsert</span> <span class="ow">&lt;-</span> <span class="n">superComplicatedAction</span>

<span class="nf">putStrLn</span> <span class="s">&quot;The following runInsert will send no commands to the database&quot;</span>
<span class="nf">runInsert</span> <span class="o">$</span> <span class="n">insert</span> <span class="p">(</span><span class="n">playlist</span> <span class="n">chinookDb</span><span class="p">)</span> <span class="o">$</span>
  <span class="n">insertValues</span> <span class="n">valuesToInsert</span>
<span class="nf">putStrLn</span> <span class="s">&quot;See! I told you!&quot;</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-23-Sqlite">
            <div class="codehilite"><pre><span></span><span class="c1">-- Output: The following runInsert will send no commands to the database</span>
<span class="c1">-- Output: See! I told you!</span>
</pre></div>

        </div>
    
        <div role="tabpanel" class="tab-pane " id="tab-23-Postgres">
            <div class="codehilite"><pre><span></span><span class="c1">-- Output: The following runInsert will send no commands to the database</span>
<span class="c1">-- Output: See! I told you!</span>
</pre></div>

        </div>
    
        </div>
    
                </div>
                    </p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../extensibility/" title="Custom queries" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Custom queries
              </span>
            </div>
          </a>
        
        
          <a href="../update/" title="UPDATE" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                UPDATE
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    

      <script src="../../../assets/javascripts/application-6b599127bc.js"></script>
      <script>app.initialize({url:{base:"../../.."}})</script>
      
    
<script type="text/javascript" language="javascript"  src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<script type="text/javascript" language="javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript" language="javascript">
 $(document.body).tab();
 $(".nav-item:first-child").tab("show");
</script>

    
      
    
  </body>
</html>